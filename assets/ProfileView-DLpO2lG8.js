import{d as L,r as u,G as V,c as j,o as M,a,b as e,f as h,e as w,t as m,F as A,w as E,g as y,v as b,H as I,I as R,J as T,j as o}from"./index-Md0QszOD.js";const z={class:"max-w-4xl mx-auto"},G={class:"bg-white border border-gray-200 rounded-lg p-6 mb-6"},H={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},J={class:"flex items-center gap-2"},W={key:0,class:"text-sm text-red-600"},$=["disabled"],K={key:0,class:"py-10 text-center text-sm text-gray-600"},O={class:"flex items-start gap-4"},Q=["src"],X={class:"flex-1 space-y-3"},Y={class:"grid grid-cols-1 gap-4"},Z=["value"],ee={class:"flex flex-col-reverse gap-3 sm:flex-row sm:justify-end sm:items-center pt-2"},se=["disabled"],te={key:1,class:"mt-6 flex flex-col gap-4"},re={class:"flex items-start gap-4"},ae=["src"],oe={class:"text-lg font-semibold text-gray-900"},le={class:"text-sm text-gray-600 mt-1"},de={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ne={class:"bg-gray-50 border border-gray-200 rounded-md px-4 py-3"},ie={class:"text-sm font-semibold text-gray-900 mt-1"},ue={class:"bg-white border border-gray-200 rounded-lg p-6 mb-6"},ce={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},me={key:0,class:"text-sm text-red-600"},ge={class:"flex flex-col-reverse gap-3 sm:flex-row sm:justify-end sm:items-center pt-2"},ye=["disabled"],be={key:1,class:"mt-6 text-sm text-gray-600"},fe=L({__name:"ProfileView",setup(ve){const l=u(null),v=u(!0),c=u(null),g=u(!1),p=u(!1),r=V({name:"",avatar:""}),t=V({currentPassword:"",newPassword:"",confirmPassword:""}),f=u(!1),x=u(!1),i=u(null),_=j(()=>l.value?.email??""),k=j(()=>{if(r.avatar.trim())return r.avatar;if(l.value?.avatar)return l.value.avatar;const d=r.name||l.value?.name||"User";return`https://ui-avatars.com/api/?name=${encodeURIComponent(d)}&background=111827&color=fff`}),P=()=>{r.name=l.value?.name||"",r.avatar=l.value?.avatar||""},C=()=>{t.currentPassword="",t.newPassword="",t.confirmPassword="",i.value=null},S=async()=>{v.value=!0,c.value=null;try{const d=await I();l.value=d,P()}catch(d){c.value=d.response?.data?.message||"無法取得個人資料"}finally{v.value=!1}},F=()=>{P(),g.value=!0},q=()=>{g.value=!1,P()},D=async()=>{if(!r.name.trim()){c.value="姓名為必填";return}p.value=!0,c.value=null;try{await R({name:r.name.trim(),avatar:r.avatar.trim()||void 0}),await S(),g.value=!1,alert("個人資料已更新")}catch(d){c.value=d.response?.data?.message||"更新個人資料失敗"}finally{p.value=!1}},N=()=>{C(),f.value=!0},U=()=>{f.value=!1,C()},B=async()=>{if(!t.currentPassword.trim()){i.value="請輸入目前密碼";return}if(t.newPassword.length<6){i.value="新密碼至少需要 6 個字元";return}if(t.newPassword!==t.confirmPassword){i.value="新密碼與確認密碼不一致";return}x.value=!0,i.value=null;try{await T({currentPassword:t.currentPassword,newPassword:t.newPassword,confirmPassword:t.confirmPassword}),alert("密碼已更新"),U()}catch(d){i.value=d.response?.data?.message||"更新密碼失敗"}finally{x.value=!1}};return M(()=>{S()}),(d,s)=>(o(),a("div",z,[s[16]||(s[16]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"個人資料"),e("p",{class:"text-gray-600"},"管理帳號資料與安全設定")],-1)),e("div",G,[e("div",H,[s[5]||(s[5]=h('<div class="flex items-center gap-3"><div class="w-10 h-10 bg-gray-100 rounded-md flex items-center justify-center"><i class="bi bi-person-circle text-gray-600 text-lg"></i></div><div><h2 class="text-lg font-semibold text-gray-900">基本資訊</h2><p class="text-sm text-gray-600">檢視與更新個人資料</p></div></div>',1)),e("div",J,[c.value?(o(),a("span",W,m(c.value),1)):w("",!0),g.value?w("",!0):(o(),a("button",{key:1,type:"button",onClick:F,disabled:v.value,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-100 transition-colors disabled:opacity-60 disabled:cursor-not-allowed"}," 編輯資料 ",8,$))])]),v.value?(o(),a("div",K," 載入中... ")):(o(),a(A,{key:1},[g.value?(o(),a("form",{key:0,onSubmit:E(D,["prevent"]),class:"mt-6 space-y-5"},[e("div",O,[e("img",{src:k.value,alt:"avatar",class:"w-20 h-20 rounded-lg border border-gray-200"},null,8,Q),e("div",X,[e("div",null,[s[6]||(s[6]=e("label",{for:"avatar",class:"block text-sm font-medium text-gray-700 mb-2"},"頭像 URL",-1)),y(e("input",{id:"avatar","onUpdate:modelValue":s[0]||(s[0]=n=>r.avatar=n),type:"url",class:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-gray-900",placeholder:"https://example.com/avatar.png"},null,512),[[b,r.avatar]])])])]),e("div",Y,[e("div",null,[s[7]||(s[7]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700 mb-2"},"姓名",-1)),y(e("input",{id:"name","onUpdate:modelValue":s[1]||(s[1]=n=>r.name=n),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-gray-900",placeholder:"輸入您的姓名"},null,512),[[b,r.name]])]),e("div",null,[s[8]||(s[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"電子郵件",-1)),e("input",{type:"email",value:_.value,disabled:"",class:"w-full px-4 py-2 border border-gray-200 rounded-md bg-gray-100 text-gray-600"},null,8,Z),s[9]||(s[9]=e("p",{class:"text-xs text-gray-500 mt-1"},"電子郵件僅供顯示，無法修改",-1))])]),e("div",ee,[e("button",{type:"button",onClick:q,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-100 transition-colors"}," 取消 "),e("button",{type:"submit",disabled:p.value,class:"px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},m(p.value?"儲存中...":"儲存變更"),9,se)])],32)):(o(),a("div",te,[e("div",re,[e("img",{src:k.value,alt:"avatar",class:"w-20 h-20 rounded-lg border border-gray-200"},null,8,ae),e("div",null,[e("p",oe,m(l.value?.name||"—"),1),e("p",le,m(_.value||"—"),1)])]),e("div",de,[s[11]||(s[11]=e("div",{class:"bg-gray-50 border border-gray-200 rounded-md px-4 py-3"},[e("p",{class:"text-xs text-gray-500"},"帳號類型"),e("p",{class:"text-sm font-semibold text-gray-900 mt-1"},"一般使用者")],-1)),e("div",ne,[s[10]||(s[10]=e("p",{class:"text-xs text-gray-500"},"註冊日期",-1)),e("p",ie,m(l.value?.createdAt?new Date(l.value.createdAt).toLocaleDateString("zh-TW"):"—"),1)])])]))],64))]),e("div",ue,[e("div",ce,[s[12]||(s[12]=h('<div class="flex items-center gap-3"><div class="w-10 h-10 bg-gray-100 rounded-md flex items-center justify-center"><i class="bi bi-shield-lock text-gray-600 text-lg"></i></div><div><h2 class="text-lg font-semibold text-gray-900">變更密碼</h2><p class="text-sm text-gray-600">建議定期更新密碼以保護帳號</p></div></div>',1)),f.value?w("",!0):(o(),a("button",{key:0,type:"button",onClick:N,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-100 transition-colors"}," 變更密碼 "))]),f.value?(o(),a("form",{key:0,onSubmit:E(B,["prevent"]),class:"mt-6 space-y-4 max-w-xl"},[e("div",null,[s[13]||(s[13]=e("label",{for:"currentPassword",class:"block text-sm font-medium text-gray-700 mb-2"},"目前密碼",-1)),y(e("input",{id:"currentPassword","onUpdate:modelValue":s[2]||(s[2]=n=>t.currentPassword=n),type:"password",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-gray-900",placeholder:"輸入目前密碼"},null,512),[[b,t.currentPassword]])]),e("div",null,[s[14]||(s[14]=e("label",{for:"newPassword",class:"block text-sm font-medium text-gray-700 mb-2"},"新密碼",-1)),y(e("input",{id:"newPassword","onUpdate:modelValue":s[3]||(s[3]=n=>t.newPassword=n),type:"password",minlength:"6",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-gray-900",placeholder:"至少 6 個字元"},null,512),[[b,t.newPassword]])]),e("div",null,[s[15]||(s[15]=e("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-700 mb-2"},"確認新密碼",-1)),y(e("input",{id:"confirmPassword","onUpdate:modelValue":s[4]||(s[4]=n=>t.confirmPassword=n),type:"password",minlength:"6",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-gray-900",placeholder:"再次輸入新密碼"},null,512),[[b,t.confirmPassword]])]),i.value?(o(),a("p",me,m(i.value),1)):w("",!0),e("div",ge,[e("button",{type:"button",onClick:U,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-100 transition-colors"}," 取消 "),e("button",{type:"submit",disabled:x.value,class:"px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},m(x.value?"更新中...":"更新密碼"),9,ye)])],32)):(o(),a("div",be,"保持強度高且獨特的密碼，保障您的帳號安全。"))]),s[17]||(s[17]=h('<div class="bg-white border border-gray-200 rounded-lg p-6"><div class="flex items-center gap-3 mb-3"><div class="w-10 h-10 bg-gray-100 rounded-md flex items-center justify-center"><i class="bi bi-exclamation-triangle text-gray-600 text-lg"></i></div><div><h2 class="text-lg font-semibold text-gray-900">帳號刪除</h2><p class="text-sm text-gray-600">目前尚未開放刪除帳號功能</p></div></div><p class="text-sm text-gray-500 mb-4"> 若需要協助，請聯繫客服或管理員。我們將儘速協助處理相關需求。 </p><button type="button" disabled class="px-4 py-2 border border-gray-300 text-gray-500 rounded-md bg-gray-100 cursor-not-allowed"> 刪除帳號 (尚未開放) </button></div>',1))]))}});export{fe as default};
