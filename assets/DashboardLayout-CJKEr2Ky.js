import{d as _,k as T,c as $,a as l,F as x,l as f,m as D,n as g,j as n,b as e,t as h,p as K,q as v,h as N,s as u,x as m,T as I,y as z,z as k,_ as B,u as L,r as C,e as S,i as U}from"./index-Dg8mVS7j.js";import{_ as V}from"./RoleBadge.vue_vue_type_script_setup_true_lang-CCjHbrR2.js";import{u as A}from"./useToast-WH4QaZkr.js";const F={class:"space-y-6"},G={class:"px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider"},P={class:"space-y-1"},j=_({__name:"SidebarNav",setup(y){const p=D(),c=T(),a=[{title:"Discord 排程",items:[{name:"新增排程",path:"/dashboard/schedule/new",icon:"bi-plus-circle",permissionKey:"showScheduleNew"},{name:"排程行事曆",path:"/dashboard/schedule/calendar",icon:"bi-calendar-check",permissionKey:"showScheduleCalendar"},{name:"排程狀態",path:"/dashboard/schedule/status",icon:"bi-clock-history",permissionKey:"showScheduleStatus"},{name:"Discord 設定",path:"/dashboard/discord",icon:"bi-discord",permissionKey:"showDiscord"}]},{title:"打卡管理",items:[{name:"打卡排程",path:"/dashboard/checkin/schedules",icon:"bi-clipboard-check",permissionKey:"showCheckinSchedules"}]},{title:"系統管理",showIf:()=>c.isAdmin(),items:[{name:"使用者管理",path:"/dashboard/admin/users",icon:"bi-people",permissionKey:"showUserManagement"}]},{title:"帳號設定",items:[{name:"個人資料",path:"/dashboard/profile",icon:"bi-person-circle",permissionKey:"showProfile"}]}],o=$(()=>a.map(s=>{if(s.showIf&&!s.showIf())return null;const r=s.items.filter(t=>c.shouldShowNavItem(t.permissionKey));return r.length===0?null:{...s,items:r}}).filter(s=>s!==null));function i(s){return p.path===s||p.path.startsWith(`${s}/`)}return(s,r)=>{const t=g("router-link");return n(),l("nav",F,[(n(!0),l(x,null,f(o.value,b=>(n(),l("div",{key:b.title,class:"space-y-2"},[e("h3",G,h(b.title),1),e("div",P,[(n(!0),l(x,null,f(b.items,d=>(n(),K(t,{key:d.path,to:d.path,class:u(["flex items-center px-3 py-2.5 text-gray-700 rounded-lg hover:bg-indigo-50 hover:text-indigo-600 transition cursor-pointer",{"bg-indigo-50 text-indigo-600":i(d.path)}])},{default:v(()=>[e("i",{class:u([d.icon,"text-lg mr-3"])},null,2),N(" "+h(d.name),1)]),_:2},1032,["to","class"]))),128))])]))),128))])}}}),E={class:"fixed top-4 right-4 z-[9999] flex flex-col gap-2 max-w-sm w-full pointer-events-none"},M=["onClick"],O=_({__name:"ToastContainer",setup(y){const{toasts:p,remove:c}=A(),a={success:{bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-800",icon:"bi-check-circle-fill",iconColor:"text-emerald-500"},error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-800",icon:"bi-x-circle-fill",iconColor:"text-red-500"},warning:{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-800",icon:"bi-exclamation-triangle-fill",iconColor:"text-amber-500"},info:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-800",icon:"bi-info-circle-fill",iconColor:"text-blue-500"}};function o(i){return a[i]||a.info}return(i,s)=>(n(),K(z,{to:"body"},[e("div",E,[m(I,{name:"toast"},{default:v(()=>[(n(!0),l(x,null,f(k(p),r=>(n(),l("div",{key:r.id,class:u(["pointer-events-auto rounded-lg border p-4 shadow-lg flex items-start gap-3",[o(r.type).bg,o(r.type).border]])},[e("i",{class:u(["bi text-lg flex-shrink-0",[o(r.type).icon,o(r.type).iconColor]])},null,2),e("p",{class:u(["text-sm flex-1",o(r.type).text])},h(r.message),3),e("button",{type:"button",class:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition cursor-pointer",onClick:t=>k(c)(r.id)},[...s[0]||(s[0]=[e("i",{class:"bi bi-x text-lg"},null,-1)])],8,M)],2))),128))]),_:1})])]))}}),R=B(O,[["__scopeId","data-v-c6604601"]]),q={class:"min-h-screen bg-gray-100"},W={class:"h-full px-3 py-4 overflow-y-auto"},H={class:"bg-white shadow-sm sticky top-0 z-30"},J={class:"flex items-center justify-between px-6 py-4"},Q={class:"relative"},X=["src"],Y={class:"text-left hidden md:block"},Z={class:"text-sm font-medium text-gray-700"},ee={class:"text-xs text-gray-500"},te={key:0,class:"mt-1"},se={key:0,class:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-1 border border-gray-200"},oe={class:"p-6 relative"},ae=_({__name:"DashboardLayout",setup(y){const p=U(),c=L(),a=C(!0),o=C(!1),i=$(()=>c.user),s=async()=>{o.value=!1,await c.logout(),p.replace({name:"Login"})};return(r,t)=>{const b=g("router-link"),d=g("router-view");return n(),l("div",q,[e("aside",{class:u(["fixed top-0 left-0 z-40 h-screen transition-transform",a.value?"translate-x-0":"-translate-x-full","w-64 bg-white shadow-lg"])},[e("div",W,[t[3]||(t[3]=e("div",{class:"mb-8 px-3"},[e("h1",{class:"text-2xl font-bold text-indigo-600"},"Discord 排程"),e("p",{class:"text-sm text-gray-500 mt-1"},"訊息管理工具")],-1)),m(j)])],2),e("div",{class:u(["transition-all",a.value?"ml-64":"ml-0"])},[e("header",H,[e("div",J,[e("button",{onClick:t[0]||(t[0]=w=>a.value=!a.value),class:"text-gray-500 hover:text-gray-700 cursor-pointer"},[...t[4]||(t[4]=[e("i",{class:"bi bi-list text-2xl"},null,-1)])]),e("div",Q,[e("button",{onClick:t[1]||(t[1]=w=>o.value=!o.value),class:"flex items-center gap-3 hover:bg-gray-50 rounded-lg px-3 py-2 transition cursor-pointer"},[e("img",{src:i.value?.avatar||"https://ui-avatars.com/api/?name=User&background=4F46E5&color=fff",alt:"User",class:"w-8 h-8 rounded-full"},null,8,X),e("div",Y,[e("p",Z,h(i.value?.name||"訪客"),1),e("p",ee,h(i.value?.email||""),1),i.value?.role?(n(),l("div",te,[m(V,{role:i.value.role},null,8,["role"])])):S("",!0)]),t[5]||(t[5]=e("i",{class:"bi bi-chevron-down text-gray-500"},null,-1))]),o.value?(n(),l("div",se,[m(b,{to:"/dashboard/profile",class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer",onClick:t[2]||(t[2]=w=>o.value=!1)},{default:v(()=>[...t[6]||(t[6]=[N(" 個人資料 ",-1)])]),_:1}),t[7]||(t[7]=e("hr",{class:"my-1"},null,-1)),e("button",{onClick:s,class:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 cursor-pointer"}," 登出 ")])):S("",!0)])])]),e("main",oe,[m(d)])],2),m(R)])}}});export{ae as default};
